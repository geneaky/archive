멀티 모듈

하나의 서비스나 프로젝트를 여러개의 모듈로 분리한 것

분리한 이유? 
중복코드를 줄일 수 있고, 어떠한 기준에 맞춰 모듈을 분리했기 때문에 유지보수도 쉬움
어떠한 기준이라 하믄 개인이 판단하기에 도메인 기준, 백엔드 기준(서비스 관리/운영 측면)을 예시로 들 수 있겠고 개인이 더 명확하고 좋다고 생각하는 기준이 있으면 그걸 기준으로 세워도 좋을듯 하다

멀티보듈 프로젝트가 중요한 이유?
초기에 이루어져야 하는 일련의 설계 결정.
요소의 구조와 그 관계에 관한것.
나중에 변경하기 어렵다는 의미

모듈 간 역할, 책임, 협력 관계가 올바른지 고려하여 생각해야한다.

##### 주의
core & common
서비스 도메인 기반의 구조가 아니라 기술 베이스 지향적인 모듈 구조
데이터 접근 모듈을 분리
외부 api 연동 모듈 분리 

그렇지만 중복 코드를 없애자고 모든 모듈에서 core & common을 의존하고 있으면 사용하지 않는 의존성이 너무 많이 생기므로 일부 코드 중복을 수용하는 것이 좋다고 생각함

모듈을 사용하여 코드 중복을 최소화 한다고 했지 모든 중복을 없애자고는 하지 않았음.
그러므로 유지보수를 위해 일부 중복을 허용하는 것이 좋다고 생각한것에 나는 동의함.


##### 멀미모튤 그룹 경계 나누기
- Boot(Server) : 서버모듈(잦은변화) - batch, admin, api
- Data(Domain) : 데이터모듈(+도메인) -  meata, user, chart
- Infra : 연동모듈(큰변화) - 유관부서 및 업체연동을 위한 모듈 vod, photo, billing
- Cloud(System) : 클라우드(시스템)모듈(변화적음) - config, gateway, discovery, aws, gcp, azure

각 멀티 모듈 그룹 하위에 모듈들이 있다


Data -> infra 모듈 관계 

Data에서 명시된 interface를 구현하는 구현체가 db접근을 하는 경우 Data모듈에 해당 접근 로직을 작성하고
infra 접근에 대한 로직만 infra 모듈에서 구현을 한다.

Server -> data 모듈 관계
service레이어의 구현은 어디에 있어야하나?
각각 모듈에 구현되어야 한다.
예)
server에서 특정 데이터 생성 이벤트를 발송하는 구현을 작성했다면
data에서는 해당 이벤트를 받아서 data가 책임을 맡고있는 데이터 생성 처리를 진행한다.

cloud 모듈과 server 모듈 관계

MSA 에서 멀티모듈이 부각되는 이유는 역할, 의존성의 분리를 통해 시스템의 분리, 통합을 유연하게 만들어 줄 수 있는 좋은 아키텍처를 만들 수 있기 때문

좋은 아키텍처는 시스템이 모노리틱 구조로 태어나서 단일 파일로 배포되더라도, 이후에는 독립적으로 배포 가능한 단위들의 집합으로 성장하고, 또 독립적인 서비스나 마이크로서비스 수준까지 성장할 수 있또록 만들어져야한다.
또한 좋은 아키텍처라면 나중에 상황이 바뀌었을 때 이 진행 방향을 거꾸로 돌려 원래 형태인 모노리틱 구조로 되돌릴 수도 있어야한다.

---
내 생각 

소프트웨어를 초기부터 분리할 수 있을까?
소프트웨어가 제공하는 가치의 기반인 도메인이 기존에 익숙한 도메인이라면 초기에 여러 모듈로 분리하며 작업하는 것은 가능하다고 보지만, 도메인이 미숙한 상황이라면 위에 언급처럼 초기에는 모노ㅌ리틱 구조로 태어나서 단일 파일로 배포가 되는 상태일 것이고 이후 서비스가 점차 커지고, 요구사항도 많아지고, 도메인 성숙도가 높아짐에 따라 세포를 키우듯 소프트웨어를 성장하기 가장 좋은 '형태'로 만들게 될 것이며 그 과정에서 멀티모듈로 전환하는 선택을 하게될 것 같다.

---
- 단일 모듈 멀티 프로젝트 + 내부 Maven 저장소
	- 사설 maven repo를 만들어 각각의 프로젝트에서 공유하고 있는 DTO나 도메인 클래스를 분리 후 프로젝트화 시켜 내부 maven 저장소에 업로드
		- 이 방식은 시스템적으로 일관성을 보장 받음.
		- 문제는 여러 IDE project창에서 내부 maven repo로 부터 배포된 내용을 다운로드하고, 기능 하나 개발에 여러 프로젝트를 이동해야하기 때문에 개발 생산성이 떨어짐
- 멀티 모듈 단일 프로젝트
	- 프로젝튼느 하나이고, 그 안에 여러 개의 모듈을 설치 가능한 방법
	- IDE 1개 사용 + 시스템적으로 보장되는 일관성 -> 개발 생산성 증가
	- 모듈확립에 대한 어려움

###### 실패한 멀티 모듈이란?
모든 공통 로직을 분리하여 common(core)라는 모듈을 만들어 모든 모듈이 해당 모듈을 의존하도록 하는것
이 방식은 이후 common이 점차 커지며 common안에 비즈니스 표현이 보이기 시작한다.
원래라면 다른 모듈에 추가되어야할 표현이 어쩔 수 없이 common에 추가되는 사태가 발생할 수 있음.
다른 모듈은 간소화되지만 common만 비대해지는 상황이 발생함

커먼 모듈에 DB관련 설정이 있는 경우 애플리케이션 구성시 각 모듈이 필요한 DB커넥션 수가 다를텐데 common에 설정한 커넥션 수로 전체 모듈에 커넥션 수가 지정되어 버리는 경우 -> connection 부족이 발생 가능함

###### 그렇다면 실패하게된 근본적인 문제는?
1. 모듈에 대한 정의가 모호함
2. 모듈화란 무엇이고, 무엇을 중심으로 정의내려야하는지 알아야함
	1. 역할과 책임이 명확하다면 좋은 모듈이 될 수 있을까?
	2. 역할과 책임에 대한 범위는 어떻게 잡아야할까?

###### 구성시 주의사항
독립적으로 실행 가능한 애플리케이션을 "서비스"라고 부르고, 1개 이상의 "서비스"와 "공유 인프라"가 모여 하나의 "시스템"을 구성한다.

애플리케이션 비즈니스 vs 도메인 비즈니스

서비스에 대한 플로우나 흐름을 제어하면 애플리케이션 비즈니스(구현 레이어)
도메인 다누이에서 생성/변경/소멸의 라이프 사이클을 가지면 도메인 비즈니스

